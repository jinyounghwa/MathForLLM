# Day 16: ì „ì¹˜í–‰ë ¬ (Transpose) (1ì‹œê°„)

## ğŸ“š í•™ìŠµ ëª©í‘œ
- ì „ì¹˜í–‰ë ¬ì˜ ì •ì˜ì™€ ê³„ì‚° ë°©ë²• ì´í•´í•˜ê¸°
- ì „ì¹˜ì˜ ì„±ì§ˆê³¼ í™œìš© íŒŒì•…í•˜ê¸°
- Attentionì—ì„œ QK^Tì˜ ì˜ë¯¸ ì´í•´í•˜ê¸°

---

## ğŸ¯ ê°•ì˜ ì£¼ì œ
**"í–‰ê³¼ ì—´ì„ ë°”ê¾¸ê¸°"**

---

## ğŸ“– í•µì‹¬ ê°œë…

### 1. ì „ì¹˜í–‰ë ¬ì˜ ì •ì˜

**ì „ì¹˜ (Transpose)**: í–‰ê³¼ ì—´ì„ ë°”ê¾¼ ê²ƒ
```
A^T[i, j] = A[j, i]
```

**ì˜ˆì‹œ**:
```
A = [1  2  3]      A^T = [1  4]
    [4  5  6]            [2  5]
                         [3  6]

(2Ã—3) â†’ (3Ã—2)
```

**ë²¡í„°ì˜ ì „ì¹˜**:
```
v = [1]      v^T = [1  2  3]
    [2]
    [3]

ì—´ ë²¡í„° â†” í–‰ ë²¡í„°
```

---

### 2. ì „ì¹˜ì˜ ì„±ì§ˆ

**1. ë‘ ë²ˆ ì „ì¹˜í•˜ë©´ ì›ë˜ëŒ€ë¡œ**:
```
(A^T)^T = A
```

**2. í•©ì˜ ì „ì¹˜**:
```
(A + B)^T = A^T + B^T
```

**3. ê³±ì˜ ì „ì¹˜ (ì¤‘ìš”!)**:
```
(AB)^T = B^T A^T

ìˆœì„œê°€ ë°”ë€ë‹ˆë‹¤!
```

**ì¦ëª…**:
```
(AB)^T[i,j] = AB[j,i]
            = Î£_k A[j,k] B[k,i]
            = Î£_k B^T[i,k] A^T[k,j]
            = (B^T A^T)[i,j]
```

**4. ìŠ¤ì¹¼ë¼ë°°ì˜ ì „ì¹˜**:
```
(kA)^T = k A^T
```

---

### 3. ëŒ€ì¹­í–‰ë ¬

**ëŒ€ì¹­í–‰ë ¬**: A^T = A
```
A = [1  2  3]
    [2  4  5]
    [3  5  6]

A^T = A â†’ ëŒ€ì¹­!
```

**ì„±ì§ˆ**:
- ì£¼ ëŒ€ê°ì„  ê¸°ì¤€ìœ¼ë¡œ ëŒ€ì¹­
- ì •ì‚¬ê° í–‰ë ¬ë§Œ ê°€ëŠ¥
- ê³ ìœ ê°’ì´ ëª¨ë‘ ì‹¤ìˆ˜

---

### 4. ë‚´ì ê³¼ ì „ì¹˜

**ë‚´ì ì˜ í–‰ë ¬ í‘œí˜„**:
```
a Â· b = a^T b = [aâ‚  aâ‚‚  aâ‚ƒ] [bâ‚]
                              [bâ‚‚]
                              [bâ‚ƒ]
      = aâ‚bâ‚ + aâ‚‚bâ‚‚ + aâ‚ƒbâ‚ƒ
```

**êµí™˜ ë²•ì¹™**:
```
a^T b = b^T a  (ë‘˜ ë‹¤ ìŠ¤ì¹¼ë¼)
```

---

## ğŸ’» Python ì‹¤ìŠµ

### ì‹¤ìŠµ 1: ì „ì¹˜ ê³„ì‚°
```python
import numpy as np

# í–‰ë ¬ ì •ì˜
A = np.array([[1, 2, 3],
              [4, 5, 6]])

print("=== ì „ì¹˜í–‰ë ¬ ===")
print(f"A =\n{A}\n")
print(f"A í˜•íƒœ: {A.shape}\n")

# ì „ì¹˜
A_T = A.T

print(f"A^T =\n{A_T}\n")
print(f"A^T í˜•íƒœ: {A_T.shape}\n")

# ë‘ ë²ˆ ì „ì¹˜
A_T_T = A_T.T
print(f"(A^T)^T =\n{A_T_T}\n")
print(f"ì›ë˜ í–‰ë ¬ê³¼ ê°™ìŒ: {np.array_equal(A, A_T_T)}")
```

### ì‹¤ìŠµ 2: ë‚´ì ê³¼ ì „ì¹˜
```python
import numpy as np

# ë²¡í„°
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

print("=== ë‚´ì ê³¼ ì „ì¹˜ ===")
print(f"a = {a}")
print(f"b = {b}\n")

# ë°©ë²• 1: np.dot
dot1 = np.dot(a, b)
print(f"np.dot(a, b) = {dot1}")

# ë°©ë²• 2: ì „ì¹˜ ì‚¬ìš©
dot2 = a.T @ b  # ë˜ëŠ” a @ b
print(f"a^T @ b = {dot2}")

# ë°©ë²• 3: ëª…ì‹œì  ì „ì¹˜
a_col = a.reshape(-1, 1)  # ì—´ ë²¡í„°
b_col = b.reshape(-1, 1)
dot3 = (a_col.T @ b_col)[0, 0]
print(f"a^T b (ëª…ì‹œì ) = {dot3}\n")

print(f"ëª¨ë‘ ê°™ìŒ: {dot1 == dot2 == dot3}")
```

### ì‹¤ìŠµ 3: Attentionì˜ QK^T
```python
import numpy as np

# Queryì™€ Key í–‰ë ¬ (batch Ã— seq_len Ã— d_k)
batch_size = 2
seq_len = 3
d_k = 4

Q = np.random.randn(batch_size, seq_len, d_k)
K = np.random.randn(batch_size, seq_len, d_k)

print("=== Attention: QK^T ===")
print(f"Q í˜•íƒœ: {Q.shape}")
print(f"K í˜•íƒœ: {K.shape}\n")

# ë°°ì¹˜ë³„ë¡œ QK^T ê³„ì‚°
attention_scores = np.zeros((batch_size, seq_len, seq_len))

for b in range(batch_size):
    # Q[b]: (seq_len Ã— d_k)
    # K[b]^T: (d_k Ã— seq_len)
    # QK^T: (seq_len Ã— seq_len)
    attention_scores[b] = Q[b] @ K[b].T

print(f"QK^T í˜•íƒœ: {attention_scores.shape}")
print(f"\nì²« ë²ˆì§¸ ë°°ì¹˜ì˜ attention scores:\n{attention_scores[0]}\n")

print("í•´ì„:")
print("  - ê° í–‰: í•œ Queryê°€ ëª¨ë“  Keyì™€ì˜ ìœ ì‚¬ë„")
print("  - attention_scores[i,j]: ië²ˆì§¸ í† í°ì´ jë²ˆì§¸ í† í°ì— ì£¼ëŠ” attention")
```

---

## âœï¸ ì† ê³„ì‚° ì—°ìŠµ

### ì—°ìŠµ 1: ì „ì¹˜
```
A = [1  2]      A^T = [1  3]
    [3  4]            [2  4]
```

### ì—°ìŠµ 2: ê³±ì˜ ì „ì¹˜
```
A = [1  2]    B = [5  6]
    [3  4]        [7  8]

AB = [19  22]    (AB)^T = [19  43]
     [43  50]              [22  50]

B^T = [5  7]    A^T = [1  3]
      [6  8]          [2  4]

B^T A^T = [5Ã—1+7Ã—2  5Ã—3+7Ã—4]  = [19  43]
          [6Ã—1+8Ã—2  6Ã—3+8Ã—4]    [22  50]

(AB)^T = B^T A^T âœ“
```

### ì—°ìŠµ 3: ë‚´ì 
```
a = [1, 2, 3]
b = [4, 5, 6]

a^T b = [1  2  3] [4]  = 1Ã—4 + 2Ã—5 + 3Ã—6 = 32
                  [5]
                  [6]
```

---

## ğŸ”— LLM ì—°ê²°ì 

### 1. Attentionì˜ QK^T
```
Attention(Q, K, V) = softmax(QK^T / âˆšd_k) V

QK^T: (seq_len Ã— d_k) @ (d_k Ã— seq_len)
    = (seq_len Ã— seq_len)

ëª¨ë“  Query-Key ìŒì˜ ìœ ì‚¬ë„ í–‰ë ¬!
```

### 2. ê°€ì¤‘ì¹˜ í–‰ë ¬
```
# PyTorch/TensorFlow
y = x @ W.T + b

W.Të¥¼ ì‚¬ìš©í•˜ì—¬ ì°¨ì›ì„ ë§ì¶¤
```

### 3. ê·¸ëŒ í–‰ë ¬ (Gram Matrix)
```
G = X^T X

íŠ¹ì§•ë“¤ ê°„ì˜ ìƒê´€ê´€ê³„
ìŠ¤íƒ€ì¼ ì „ì´(Style Transfer)ì—ì„œ ì‚¬ìš©
```

---

## âœ… ì²´í¬í¬ì¸íŠ¸

- [ ] **ì „ì¹˜í–‰ë ¬ì„ ê³„ì‚°í•  ìˆ˜ ìˆë‚˜ìš”?**

- [ ] **(AB)^T = B^T A^Të¥¼ ì´í•´í–ˆë‚˜ìš”?**

- [ ] **ë‚´ì ì„ ì „ì¹˜ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‚˜ìš”?**

- [ ] **QK^Tì˜ ì˜ë¯¸ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‚˜ìš”?**

---

## ğŸ“ í•µì‹¬ ìš”ì•½

1. **ì „ì¹˜**: A^T[i,j] = A[j,i]
2. **ê³±ì˜ ì „ì¹˜**: (AB)^T = B^T A^T
3. **ë‚´ì **: a Â· b = a^T b
4. **Attention**: QK^T = ìœ ì‚¬ë„ í–‰ë ¬

### ë‹¤ìŒ í•™ìŠµ
- **Day 17**: ì—­í–‰ë ¬ê³¼ ë‹¨ìœ„í–‰ë ¬

---

**ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!** ğŸ‰

**ì „ì¹˜ëŠ” ì°¨ì›ì„ ë§ì¶”ëŠ” ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤!**
